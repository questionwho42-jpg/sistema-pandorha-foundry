<form class="pandorha-sheet" autocomplete="off">
  <header class="sheet-header">
    <div class="header-main">
      <input class="name" name="name" type="text" value="{{actor.name}}" />
      <div class="subline">
        <label>Nível</label>
        <input name="system.attributes.level" type="number" value="{{system.attributes.level}}" />
        <label>Ancestralidade</label>
        <input name="system.details.ancestry" type="text" value="{{system.details.ancestry}}" />
        <label>Classe</label>
        <input name="system.details.class" type="text" value="{{system.details.class}}" />
        <label>Antecedente</label>
        <input name="system.details.background" type="text" value="{{system.details.background}}" />
      </div>
    </div>
  </header>

  <section class="grid">
    <div class="panel">
      <h3>Eixos</h3>
      <div class="stats">
        <label>Físico</label>
        <input name="system.eixos.fisico" type="number" value="{{system.eixos.fisico}}" />
        <label>Mental</label>
        <input name="system.eixos.mental" type="number" value="{{system.eixos.mental}}" />
        <label>Social</label>
        <input name="system.eixos.social" type="number" value="{{system.eixos.social}}" />
      </div>
    </div>

    <div class="panel">
      <h3>Aplicações</h3>
      <div class="stats">
        <label>Conflito</label>
        <input name="system.aplicacoes.conflito" type="number" value="{{system.aplicacoes.conflito}}" />
        <label>Interação</label>
        <input name="system.aplicacoes.interacao" type="number" value="{{system.aplicacoes.interacao}}" />
        <label>Resistência</label>
        <input name="system.aplicacoes.resistencia" type="number" value="{{system.aplicacoes.resistencia}}" />
      </div>
    </div>

    <div class="panel">
      <h3>Recursos</h3>
      <div class="stats">
        <label>HP</label>
        <input name="system.resources.hp.value" type="number" value="{{system.resources.hp.value}}" />
        <span>/</span>
        <input name="system.resources.hp.max" type="number" value="{{system.resources.hp.max}}" />

        <label>PV</label>
        <input name="system.resources.pv.value" type="number" value="{{system.resources.pv.value}}" />
        <span>/</span>
        <input name="system.resources.pv.max" type="number" value="{{system.resources.pv.max}}" />

        <label>EE</label>
        <input name="system.resources.ee.value" type="number" value="{{system.resources.ee.value}}" />
        <span>/</span>
        <input name="system.resources.ee.max" type="number" value="{{system.resources.ee.max}}" />
      </div>
      <div class="stats">
        <label>CA</label>
        <input name="system.defenses.ca" type="number" value="{{system.defenses.ca}}" />
        <label>Mov</label>
        <input name="system.movement.base" type="number" value="{{system.movement.base}}" />
      </div>
    </div>

    <div class="panel">
      <h3>Rolagem</h3>
      <div class="roll-row">
        <select name="roll-eixo">
          <option value="fisico">Físico</option>
          <option value="mental">Mental</option>
          <option value="social">Social</option>
        </select>
        <select name="roll-aplicacao">
          <option value="conflito">Conflito</option>
          <option value="interacao">Interação</option>
          <option value="resistencia">Resistência</option>
        </select>
        <input name="roll-bonus" type="number" value="0" />
        <select name="roll-map">
          <option value="auto">MAP Auto</option>
          <option value="0">MAP 0</option>
          <option value="1">MAP 1</option>
          <option value="2">MAP 2</option>
        </select>
        <label class="inline">Treinado
          <input name="roll-trained" type="checkbox" checked />
        </label>
        <button type="button" data-action="roll-test">Rolar</button>
      </div>
      <div class="derived">
        <div>Iniciativa base: {{system.derived.initiative}}</div>
        <div>Slots usados: {{system.derived.carrySlots}} / {{system.derived.carryMax}}</div>
        <div>Tier: {{system.attributes.tier}}</div>
        <div>DC Mundana: {{system.derived.dcTable.mundana}} | Desafiadora: {{system.derived.dcTable.desafiadora}} | Lendária: {{system.derived.dcTable.lendaria}} | Divina: {{system.derived.dcTable.divina}}</div>
      </div>
    </div>
  </section>

  <section class="panel">
    <h3>Origem</h3>
    <div class="item-list">
      <div class="item-row">
        <span class="item-name">Ancestralidade: {{system.details.ancestry}}</span>
        <div class="item-actions">
          <button type="button" data-action="open-compendium" data-pack="pandorha.ancestries">Abrir Compêndio</button>
          <button type="button" data-action="add-from-pack" data-pack="pandorha.ancestries" data-item-type="ancestry">Adicionar</button>
        </div>
      </div>
      <div class="item-row">
        <span class="item-name">Antecedente: {{system.details.background}}</span>
        <div class="item-actions">
          <button type="button" data-action="open-compendium" data-pack="pandorha.backgrounds">Abrir Compêndio</button>
          <button type="button" data-action="add-from-pack" data-pack="pandorha.backgrounds" data-item-type="background">Adicionar</button>
        </div>
      </div>
      <div class="item-row">
        <span class="item-name">Classe: {{system.details.class}}</span>
        <div class="item-actions">
          <button type="button" data-action="open-compendium" data-pack="pandorha.classes">Abrir Compêndio</button>
          <button type="button" data-action="add-from-pack" data-pack="pandorha.classes" data-item-type="class">Adicionar</button>
        </div>
      </div>
    </div>
  </section>

  <section class="panel">
    <h3>Perícias</h3>
    <div class="item-list">
      {{#each skills}}
      <div class="item-row">
        <span class="item-name">{{label}}</span>
        <div class="item-actions">
          <label class="inline">Treinado
            <input name="system.skills.{{id}}.trained" type="checkbox" {{#if trained}}checked{{/if}} />
          </label>
          <input name="system.skills.{{id}}.bonus" type="number" value="{{bonus}}" />
          <button type="button" data-action="roll-skill" data-skill-id="{{id}}">Rolar</button>
        </div>
      </div>
      {{/each}}
    </div>
  </section>

  <section class="panel">
    <h3>Itens</h3>

    <div class="item-section">
      <div class="item-header">
        <span>Armas</span>
        <button type="button" data-action="item-create" data-item-type="weapon">Adicionar</button>
      </div>
      <div class="item-list">
        {{#each items.weapons}}
        <div class="item-row">
          <span class="item-name">{{name}} ({{system.weapon.damage}})</span>
          <div class="item-actions">
            <button type="button" data-action="item-roll" data-item-id="{{_id}}">Ataque</button>
            <button type="button" data-action="item-damage" data-item-id="{{_id}}">Dano</button>
            <button type="button" data-action="item-edit" data-item-id="{{_id}}">Editar</button>
            <button type="button" data-action="item-delete" data-item-id="{{_id}}">Remover</button>
          </div>
        </div>
        {{/each}}
      </div>
    </div>

    <div class="item-section">
      <div class="item-header">
        <span>Magias</span>
        <div class="item-actions">
          <button type="button" data-action="open-compendium" data-pack="pandorha.spells">Compêndio</button>
          <button type="button" data-action="add-from-pack" data-pack="pandorha.spells" data-item-type="spell">Adicionar</button>
          <button type="button" data-action="item-create" data-item-type="spell">Criar</button>
        </div>
      </div>
      <div class="item-list">
        {{#each items.spells}}
        <div class="item-row">
          <span class="item-name">{{name}} (Círculo {{system.circle}})</span>
          <div class="item-actions">
            <button type="button" data-action="item-roll" data-item-id="{{_id}}">Ataque</button>
            <button type="button" data-action="item-damage" data-item-id="{{_id}}">Dano</button>
            <button type="button" data-action="item-edit" data-item-id="{{_id}}">Editar</button>
            <button type="button" data-action="item-delete" data-item-id="{{_id}}">Remover</button>
          </div>
        </div>
        {{/each}}
      </div>
    </div>

    <div class="item-section">
      <div class="item-header">
        <span>Manobras</span>
        <div class="item-actions">
          <button type="button" data-action="open-compendium" data-pack="pandorha.maneuvers">Compêndio</button>
          <button type="button" data-action="add-from-pack" data-pack="pandorha.maneuvers" data-item-type="maneuver">Adicionar</button>
          <button type="button" data-action="item-create" data-item-type="maneuver">Criar</button>
        </div>
      </div>
      <div class="item-list">
        {{#each items.maneuvers}}
        <div class="item-row">
          <span class="item-name">{{name}}</span>
          <div class="item-actions">
            <button type="button" data-action="item-roll" data-item-id="{{_id}}">Rolar</button>
            <button type="button" data-action="item-damage" data-item-id="{{_id}}">Dano</button>
            <button type="button" data-action="item-edit" data-item-id="{{_id}}">Editar</button>
            <button type="button" data-action="item-delete" data-item-id="{{_id}}">Remover</button>
          </div>
        </div>
        {{/each}}
      </div>
    </div>

    <div class="item-section">
      <div class="item-header">
        <span>Características</span>
        <button type="button" data-action="item-create" data-item-type="feature">Adicionar</button>
      </div>
      <div class="item-list">
        {{#each items.features}}
        <div class="item-row">
          <span class="item-name">{{name}}</span>
          <div class="item-actions">
            <button type="button" data-action="item-roll" data-item-id="{{_id}}">Rolar</button>
            <button type="button" data-action="item-damage" data-item-id="{{_id}}">Dano</button>
            <button type="button" data-action="item-edit" data-item-id="{{_id}}">Editar</button>
            <button type="button" data-action="item-delete" data-item-id="{{_id}}">Remover</button>
          </div>
        </div>
        {{/each}}
      </div>
    </div>

    <div class="item-section">
      <div class="item-header">
        <span>Talentos</span>
        <div class="item-actions">
          <button type="button" data-action="open-compendium" data-pack="pandorha.talents">Compêndio</button>
          <button type="button" data-action="add-from-pack" data-pack="pandorha.talents" data-item-type="talent">Adicionar</button>
          <button type="button" data-action="item-create" data-item-type="talent">Criar</button>
        </div>
      </div>
      <div class="item-list">
        {{#each items.talents}}
        <div class="item-row">
          <span class="item-name">{{name}}</span>
          <div class="item-actions">
            <button type="button" data-action="item-edit" data-item-id="{{_id}}">Editar</button>
            <button type="button" data-action="item-delete" data-item-id="{{_id}}">Remover</button>
          </div>
        </div>
        {{/each}}
      </div>
    </div>

    <div class="item-section">
      <div class="item-header">
        <span>Equipamentos</span>
        <button type="button" data-action="item-create" data-item-type="equipment">Adicionar</button>
      </div>
      <div class="item-list">
        {{#each items.equipment}}
        <div class="item-row">
          <span class="item-name">{{name}} ({{type}})</span>
          <div class="item-actions">
            <button type="button" data-action="item-edit" data-item-id="{{_id}}">Editar</button>
            <button type="button" data-action="item-delete" data-item-id="{{_id}}">Remover</button>
          </div>
        </div>
        {{/each}}
      </div>
    </div>

    <div class="item-section">
      <div class="item-header">
        <span>Condições</span>
        <button type="button" data-action="item-create" data-item-type="condition">Adicionar</button>
      </div>
      <div class="item-list">
        {{#each items.conditions}}
        <div class="item-row">
          <span class="item-name">{{name}}</span>
          <div class="item-actions">
            <button type="button" data-action="item-edit" data-item-id="{{_id}}">Editar</button>
            <button type="button" data-action="item-delete" data-item-id="{{_id}}">Remover</button>
          </div>
        </div>
        {{/each}}
      </div>
    </div>
  </section>

  <section class="panel">
    <h3>Descrição</h3>
    {{editor system.details.biography target="system.details.biography" button=true editable=editable}}
  </section>
</form>
